{
  "hash": "dc764aa7b5cd24b04106d9696355a369",
  "result": {
    "markdown": "---\ntitle: \"Data Visualization\"\nauthor: \"Muhammad Shamookh\"\ndate: \"2024-04-21\"\noutput:\n  html_document:\n    toc: true\n    toc_float: true\n    df_print: paged\n    collapsed: false\n    number_sections: true\n    toc_depth: 3\n    code_folding: hide\n---\n\n\n# Data Visualization\n\nLast compiled: 2024-05-18\n\nI learned a lot about the themes in this part.\n\n# Challenge No. 01\n\nTotal covid cases data was plotted against time. \n\n## Total covid cases - Time\n\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-1_9f385666cb3e547993abfbfdd71624b7'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ncovid_data_tbl <- read_csv(\"https://covid.ourworldindata.org/data/owid-covid-data.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Rows: 392398 Columns: 67\n#> ── Column specification ────────────────────────────────────────────────────────\n#> Delimiter: \",\"\n#> chr   (4): iso_code, continent, location, tests_units\n#> dbl  (62): total_cases, new_cases, new_cases_smoothed, total_deaths, new_dea...\n#> date  (1): date\n#> \n#> ℹ Use `spec()` to retrieve the full column specification for this data.\n#> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ncovid_data_tbl %>%\n  head(n=5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"iso_code\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"continent\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"location\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"date\"],\"name\":[4],\"type\":[\"date\"],\"align\":[\"right\"]},{\"label\":[\"total_cases\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_cases\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_cases_smoothed\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_deaths\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_deaths\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_deaths_smoothed\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_cases_per_million\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_cases_per_million\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_cases_smoothed_per_million\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_deaths_per_million\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_deaths_per_million\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_deaths_smoothed_per_million\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"reproduction_rate\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"icu_patients\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"icu_patients_per_million\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hosp_patients\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hosp_patients_per_million\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weekly_icu_admissions\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weekly_icu_admissions_per_million\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weekly_hosp_admissions\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weekly_hosp_admissions_per_million\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_tests\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_tests\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_tests_per_thousand\"],\"name\":[28],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_tests_per_thousand\"],\"name\":[29],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_tests_smoothed\"],\"name\":[30],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_tests_smoothed_per_thousand\"],\"name\":[31],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"positive_rate\"],\"name\":[32],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"tests_per_case\"],\"name\":[33],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"tests_units\"],\"name\":[34],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"total_vaccinations\"],\"name\":[35],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"people_vaccinated\"],\"name\":[36],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"people_fully_vaccinated\"],\"name\":[37],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_boosters\"],\"name\":[38],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_vaccinations\"],\"name\":[39],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_vaccinations_smoothed\"],\"name\":[40],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_vaccinations_per_hundred\"],\"name\":[41],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"people_vaccinated_per_hundred\"],\"name\":[42],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"people_fully_vaccinated_per_hundred\"],\"name\":[43],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_boosters_per_hundred\"],\"name\":[44],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_vaccinations_smoothed_per_million\"],\"name\":[45],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_people_vaccinated_smoothed\"],\"name\":[46],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"new_people_vaccinated_smoothed_per_hundred\"],\"name\":[47],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"stringency_index\"],\"name\":[48],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"population_density\"],\"name\":[49],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"median_age\"],\"name\":[50],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"aged_65_older\"],\"name\":[51],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"aged_70_older\"],\"name\":[52],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gdp_per_capita\"],\"name\":[53],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"extreme_poverty\"],\"name\":[54],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cardiovasc_death_rate\"],\"name\":[55],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"diabetes_prevalence\"],\"name\":[56],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"female_smokers\"],\"name\":[57],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"male_smokers\"],\"name\":[58],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"handwashing_facilities\"],\"name\":[59],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hospital_beds_per_thousand\"],\"name\":[60],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"life_expectancy\"],\"name\":[61],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"human_development_index\"],\"name\":[62],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"population\"],\"name\":[63],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"excess_mortality_cumulative_absolute\"],\"name\":[64],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"excess_mortality_cumulative\"],\"name\":[65],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"excess_mortality\"],\"name\":[66],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"excess_mortality_cumulative_per_million\"],\"name\":[67],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AFG\",\"2\":\"Asia\",\"3\":\"Afghanistan\",\"4\":\"2020-01-05\",\"5\":\"NA\",\"6\":\"0\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"0\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"0\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"0\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\",\"34\":\"NA\",\"35\":\"NA\",\"36\":\"NA\",\"37\":\"NA\",\"38\":\"NA\",\"39\":\"NA\",\"40\":\"NA\",\"41\":\"NA\",\"42\":\"NA\",\"43\":\"NA\",\"44\":\"NA\",\"45\":\"NA\",\"46\":\"NA\",\"47\":\"NA\",\"48\":\"0\",\"49\":\"54.422\",\"50\":\"18.6\",\"51\":\"2.581\",\"52\":\"1.337\",\"53\":\"1803.987\",\"54\":\"NA\",\"55\":\"597.029\",\"56\":\"9.59\",\"57\":\"NA\",\"58\":\"NA\",\"59\":\"37.746\",\"60\":\"0.5\",\"61\":\"64.83\",\"62\":\"0.511\",\"63\":\"41128772\",\"64\":\"NA\",\"65\":\"NA\",\"66\":\"NA\",\"67\":\"NA\"},{\"1\":\"AFG\",\"2\":\"Asia\",\"3\":\"Afghanistan\",\"4\":\"2020-01-06\",\"5\":\"NA\",\"6\":\"0\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"0\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"0\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"0\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\",\"34\":\"NA\",\"35\":\"NA\",\"36\":\"NA\",\"37\":\"NA\",\"38\":\"NA\",\"39\":\"NA\",\"40\":\"NA\",\"41\":\"NA\",\"42\":\"NA\",\"43\":\"NA\",\"44\":\"NA\",\"45\":\"NA\",\"46\":\"NA\",\"47\":\"NA\",\"48\":\"0\",\"49\":\"54.422\",\"50\":\"18.6\",\"51\":\"2.581\",\"52\":\"1.337\",\"53\":\"1803.987\",\"54\":\"NA\",\"55\":\"597.029\",\"56\":\"9.59\",\"57\":\"NA\",\"58\":\"NA\",\"59\":\"37.746\",\"60\":\"0.5\",\"61\":\"64.83\",\"62\":\"0.511\",\"63\":\"41128772\",\"64\":\"NA\",\"65\":\"NA\",\"66\":\"NA\",\"67\":\"NA\"},{\"1\":\"AFG\",\"2\":\"Asia\",\"3\":\"Afghanistan\",\"4\":\"2020-01-07\",\"5\":\"NA\",\"6\":\"0\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"0\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"0\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"0\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\",\"34\":\"NA\",\"35\":\"NA\",\"36\":\"NA\",\"37\":\"NA\",\"38\":\"NA\",\"39\":\"NA\",\"40\":\"NA\",\"41\":\"NA\",\"42\":\"NA\",\"43\":\"NA\",\"44\":\"NA\",\"45\":\"NA\",\"46\":\"NA\",\"47\":\"NA\",\"48\":\"0\",\"49\":\"54.422\",\"50\":\"18.6\",\"51\":\"2.581\",\"52\":\"1.337\",\"53\":\"1803.987\",\"54\":\"NA\",\"55\":\"597.029\",\"56\":\"9.59\",\"57\":\"NA\",\"58\":\"NA\",\"59\":\"37.746\",\"60\":\"0.5\",\"61\":\"64.83\",\"62\":\"0.511\",\"63\":\"41128772\",\"64\":\"NA\",\"65\":\"NA\",\"66\":\"NA\",\"67\":\"NA\"},{\"1\":\"AFG\",\"2\":\"Asia\",\"3\":\"Afghanistan\",\"4\":\"2020-01-08\",\"5\":\"NA\",\"6\":\"0\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"0\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"0\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"0\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\",\"34\":\"NA\",\"35\":\"NA\",\"36\":\"NA\",\"37\":\"NA\",\"38\":\"NA\",\"39\":\"NA\",\"40\":\"NA\",\"41\":\"NA\",\"42\":\"NA\",\"43\":\"NA\",\"44\":\"NA\",\"45\":\"NA\",\"46\":\"NA\",\"47\":\"NA\",\"48\":\"0\",\"49\":\"54.422\",\"50\":\"18.6\",\"51\":\"2.581\",\"52\":\"1.337\",\"53\":\"1803.987\",\"54\":\"NA\",\"55\":\"597.029\",\"56\":\"9.59\",\"57\":\"NA\",\"58\":\"NA\",\"59\":\"37.746\",\"60\":\"0.5\",\"61\":\"64.83\",\"62\":\"0.511\",\"63\":\"41128772\",\"64\":\"NA\",\"65\":\"NA\",\"66\":\"NA\",\"67\":\"NA\"},{\"1\":\"AFG\",\"2\":\"Asia\",\"3\":\"Afghanistan\",\"4\":\"2020-01-09\",\"5\":\"NA\",\"6\":\"0\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"0\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"0\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"0\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\",\"34\":\"NA\",\"35\":\"NA\",\"36\":\"NA\",\"37\":\"NA\",\"38\":\"NA\",\"39\":\"NA\",\"40\":\"NA\",\"41\":\"NA\",\"42\":\"NA\",\"43\":\"NA\",\"44\":\"NA\",\"45\":\"NA\",\"46\":\"NA\",\"47\":\"NA\",\"48\":\"0\",\"49\":\"54.422\",\"50\":\"18.6\",\"51\":\"2.581\",\"52\":\"1.337\",\"53\":\"1803.987\",\"54\":\"NA\",\"55\":\"597.029\",\"56\":\"9.59\",\"57\":\"NA\",\"58\":\"NA\",\"59\":\"37.746\",\"60\":\"0.5\",\"61\":\"64.83\",\"62\":\"0.511\",\"63\":\"41128772\",\"64\":\"NA\",\"65\":\"NA\",\"66\":\"NA\",\"67\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n#covid_data_tbl <- filter(covid_data_tbl >= as.Date(\"2020-01-01\") & covid_data_tbl <= as.Date(\"2022-12-3\"))\n\n\nplaces <- c('Germany', 'France', 'Spain', 'United Kingdom', 'United States')\nplaces_europe <- c('Germany', 'France', 'Spain', 'United Kingdom')\n\ncovid_data_tbl_selected <-  covid_data_tbl %>%\n  filter(location %in% places)\n\nlast_date <- max(covid_data_tbl$date)\nfirst_date <- min(covid_data_tbl$date)\nUS_covid_data_tbl <- covid_data_tbl %>%\n  filter(location == \"United States\", date ==\"2022-05-05\") \nus_last_case <- max(US_covid_data_tbl$total_cases)\n\n\nggplot(covid_data_tbl_selected, aes(x = date, y = total_cases)) +\n  geom_line(aes(color = location)) +\n  geom_label(x = last_date- (last_date - first_date)/50, y = us_last_case + 3 * us_last_case/100, label=us_last_case, fill = \"purple\", color = \"white\") +\n  labs(colour = \"Continent/Country\",\n       subtitle = \"As of 09/05/2022\") +\n  ggtitle(\"COVID-19 confirmed cases worldwide\") +\n  xlab(\"\") + \n  ylab(\" Cumulative Cases\") +\n  theme(title = element_text(\n          color = \"White\",\n          vjust = 1,\n          size = 9\n        ),\n        legend.position = \"bottom\",\n        legend.background = element_rect(\n           fill = \"#222222\",\n           color = \"#aaaaaa\"\n          ),\n        legend.text = element_text(\n          color = \"#aaaaaa\",\n        ),\n        legend.title = element_text(\n          color = \"#aaaaaa\",\n          hjust = 0.5,\n          vjust = 0.5\n        ),\n        axis.text.x = element_text(\n                        angle = 45,\n                        hjust = 1),\n        plot.background = element_rect(\n          color = \"#222222\",\n          fill  = \"#222222\",\n          size  = 0.1),\n        panel.background = element_rect(\n          color = \"#222222\",\n          fill = \"#222222\"\n        ),\n        panel.grid = element_line(\n          color = \"#888888\"\n        ),\n        panel.grid.minor = element_blank(),\n        legend.key = element_rect(\n          fill = \"#222222\"\n        ),\n        axis.text = element_text(\n          color = \"#aaaaaa\"\n        ),\n        axis.title = element_text(\n          color = \"white\",\n          face = \"bold\",\n          size = 13\n        ))  +\n  scale_x_date(date_breaks = \"1 month\", \n                   date_labels = \"%B '%y\") +\n  scale_y_continuous(breaks=c(0, 25000000,50000000,75000000),\n                     labels = c(\"0\", \"25M\", \"50M\", \"75M\")) +\n  guides(color=guide_legend(nrow=2, byrow=TRUE)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.\n#> ℹ Please use the `linewidth` argument instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Removed 88 rows containing missing values or values outside the scale range\n#> (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](04_data_visualization_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n # Challenge No. 2\n\nCase-fatality rate in every countries were plotted on a map.\n\n## World case-fatality rate\n\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-2_e86c18793272364411262178a6f73a56'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(MAP)\nlibrary(purrr)\n\nworld <- map_data(\"world\")\ncovid_data_tbl <- read_csv(\"https://covid.ourworldindata.org/data/owid-covid-data.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Rows: 392398 Columns: 67\n#> ── Column specification ────────────────────────────────────────────────────────\n#> Delimiter: \",\"\n#> chr   (4): iso_code, continent, location, tests_units\n#> dbl  (62): total_cases, new_cases, new_cases_smoothed, total_deaths, new_dea...\n#> date  (1): date\n#> \n#> ℹ Use `spec()` to retrieve the full column specification for this data.\n#> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nlatest_date <- covid_data_tbl$date%>%\n  max()\ncovid_data_tbl_plot <- covid_data_tbl %>%\n  select(date, location, total_cases, total_deaths) %>%\n  drop_na() %>%\n  filter(date == latest_date) \n\nworld_covid <- covid_data_tbl_plot %>%\n  mutate(location = case_when(\n    \n    location == \"United Kingdom\" ~ \"UK\",\n    location == \"United States\" ~ \"USA\",\n    location == \"Democratic Republic of Congo\" ~ \"Democratic Republic of the Congo\",\n    TRUE ~ location\n    \n  )) %>%\n  distinct() %>%\n  \n  right_join(world, c(\"location\" = \"region\")) %>%\n  mutate(case_fatality_rate = total_deaths/total_cases)\n\nggplot() +\n  geom_map(data = world_covid,\n           aes(x = long,\n               y = lat,\n               map_id = location,\n               fill = case_fatality_rate,\n               ),\n           col = \"white\",\n           map = world) +\n  scale_fill_gradient(low=\"#aa7776\", high=\"#8b0000\")+\n  theme(axis.title = element_blank(),\n        axis.text = element_blank(),\n        plot.background = element_rect(\n          fill  = \"#222222\"\n        ),\n        panel.background = element_rect(\n          fill  = \"#222222\"\n        ),\n        legend.background = element_rect(\n          fill = \"#222222\",\n          color = \"#aaaaaa\"\n        ),\n        legend.text = element_text(\n          color = \"#aaaaaa\",\n        ),\n        legend.title = element_text(\n          color = \"#aaaaaa\",\n          hjust = 0.5,\n          vjust = 0.5\n        )\n        )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in geom_map(data = world_covid, aes(x = long, y = lat, map_id =\n#> location, : Ignoring unknown aesthetics: x and y\n```\n:::\n\n::: {.cell-output-display}\n![](04_data_visualization_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}